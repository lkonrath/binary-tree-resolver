<!DOCTYPE HTML>

<html>

<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <title>Binary Tree Resolver</title>
    <link rel='stylesheet' type='text/css' href='css/resets.css'>
    <link rel='stylesheet' type='text/css' href='css/style.css'>
    <link rel='stylesheet' type='text/css' href='css/page.css'>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.1/css/font-awesome.min.css">
</head>

<body>
    <script src="javascript/BTR.js"></script>
    <script src="javascript/font-size-switcher.js"></script>
    <div class="page">
        <header class="page-header">
            <nav class="page-navbar page-navbar-left">
                <ul>
                    <li>Binary Tree Resolver</li>
                </ul>
            </nav>
        </header>
        <section class="page-section page-section-builder">
            <article>
                <div>
                    <div class="validation-message">
                        Expressão inválida! certifique-se de compor uma expressão válida utilizando as teclas disponíveis na interface e tente novamente
                    </div>
                    <input type="text" id='expression' name='expression' value='P∧Q→R' readonly/>
                </div>
                <div class="keyboard">
                    <button class="key" data-key="P">P</button>
                    <button class="key" data-key="Q">Q</button>
                    <button class="key" data-key="R">R</button>
                    <button class="key" data-key="S">S</button>
                    <button class="key" data-key="(">(</button>
                    <button class="key" data-key=")">)</button>
                    <button class="key" data-key="→">→</button>
                    <button class="key" data-key="↔">↔</button>
                    <button class="key" data-key="∧">∧</button>
                    <button class="key" data-key="∨">∨</button>
                    <button class="key" data-key="¬">¬</button>
                    <button class="key" data-key="~">~</button>
                    <button class="backspace">Backspace</button>
                </div>
                <div>
                    <button id='btn-go'>Go!</button>
                </div>
            </article>
        </section>
        <section class="page-section page-section-display">
            <div class="page-section-display-header">
                <button id='btn-decrease'>
                    <i class="fa fa-font" aria-hidden="true"></i>
                    <i class="fa fa-minus" aria-hidden="true"></i>
                </button>
                <button id='btn-increase'>
                    <i class="fa fa-font" aria-hidden="true"></i>
                    <i class="fa fa-plus" aria-hidden="true"></i>
                </button>
                <button id='btn-new'>
                    Nova Expressão
                </button>
            </div>
            <article class="widget body font-size-100">
            </article>
        </section>
        <footer class="page-footer">
            <p>powered by Lucas Konrath</p>
        </footer>
    </div>
</body>


<script>
    function buildExpressionTree(node){
          
          var wrapper = document.createElement('div'); 
          var header = document.createElement('div'); 
          var body = document.createElement('div');
          
          header.setAttribute('class','header');
          body.setAttribute('class','body');
          wrapper.setAttribute('class','wrapper');
          
          if(node.subnodes.length > 0 ){
             body.appendChild(buildExpressionTree(node.subnodes[0]));
             if(node.subnodes[1] != undefined){
                body.appendChild(buildExpressionTree(node.subnodes[1]));
             }
          }
          
          header.innerHTML = node.expression;
          wrapper.appendChild(header);
          wrapper.appendChild(body);
          
          return wrapper;
      }
      
      function displayExpression(expression){
          var nodes = getNodes(expression);
          var tree = buildExpressionTree(nodes);
          var widget = document.getElementsByClassName('widget')[0];
          widget.innerHTML = '';
          widget.appendChild(tree);
      }
      
      window.onload = function(){
          var btnGo = document.getElementById('btn-go');
          btnGo.addEventListener('click',function(){
             
             var expression = document.getElementById('expression').value; 
             var page = document.getElementsByClassName('page')[0];
             
             if (isValidExpression(expression) && expression != ''){
                page.classList.remove('page-expression-invalid');
                page.classList.add('page-display-active');
                displayExpression(expression);
             }
             else {
                page.classList.add('page-expression-invalid');
             }
          });
          
          var btnNew = document.getElementById('btn-new');
          btnNew.addEventListener('click',function(){
             var page = document.getElementsByClassName('page')[0];
             page.classList.remove('page-display-active');
          });
          
          var btnIncrease = document.getElementById('btn-increase');
          btnIncrease.addEventListener('click',function(){
             var element = document.getElementsByClassName('widget')[0];
             switchFontSize(element,'increase');
          });
          
          var btnDecrease = document.getElementById('btn-decrease');
          btnDecrease.addEventListener('click',function(){
             var element = document.getElementsByClassName('widget')[0];
             switchFontSize(element,'decrease');
          });  
          
          var keys = document.getElementsByClassName('key');
          for(var i=0; i < keys.length;i++){
              keys[i].addEventListener('click',function(event){
                  var key = event.target.getAttribute('data-key'); 
                  var input = document.getElementById('expression');
                  
                  input.value = input.value + key;
                  console.log(key);
              });
          }    
          
          var backspace = document.getElementsByClassName('backspace')[0];
          backspace.addEventListener('click',function(){
              var input = document.getElementById('expression');
              input.value = input.value.substring(0,input.value.length -1);
          })    
      }

</script>

</html>